{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport * as SecureStore from 'expo-secure-store';\nimport { api } from \"../services/api\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AuthContext = createContext(undefined);\nexport var useAuth = function useAuth() {\n  var context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  useEffect(function () {\n    checkAuthState();\n  }, []);\n  var checkAuthState = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        var token = yield SecureStore.getItemAsync('token');\n        if (token) {\n          api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          yield fetchUserProfile();\n        }\n      } catch (error) {\n        console.error('Auth check failed:', error);\n      } finally {\n        setLoading(false);\n      }\n    });\n    return function checkAuthState() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var fetchUserProfile = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        var response = yield api.get('/user/profile');\n        setUser(response.data.user);\n      } catch (error) {\n        console.error('Failed to fetch user profile:', error);\n        yield SecureStore.deleteItemAsync('token');\n        delete api.defaults.headers.common['Authorization'];\n      }\n    });\n    return function fetchUserProfile() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var login = function () {\n    var _ref4 = _asyncToGenerator(function* (email, password) {\n      try {\n        var response = yield api.post('/auth/login', {\n          email: email,\n          password: password\n        });\n        var _response$data = response.data,\n          _user = _response$data.user,\n          token = _response$data.token;\n        yield SecureStore.setItemAsync('token', token);\n        api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        setUser(_user);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        throw new Error(((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.error) || 'Login failed');\n      }\n    });\n    return function login(_x, _x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref5 = _asyncToGenerator(function* (email, password, name) {\n      try {\n        var response = yield api.post('/auth/register', {\n          email: email,\n          password: password,\n          name: name\n        });\n        var _response$data2 = response.data,\n          _user2 = _response$data2.user,\n          token = _response$data2.token;\n        yield SecureStore.setItemAsync('token', token);\n        api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        setUser(_user2);\n      } catch (error) {\n        var _error$response2, _error$response2$data;\n        throw new Error(((_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.error) || 'Registration failed');\n      }\n    });\n    return function register(_x3, _x4, _x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      yield SecureStore.deleteItemAsync('token');\n      delete api.defaults.headers.common['Authorization'];\n      setUser(null);\n    });\n    return function logout() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var updateUser = function updateUser(userData) {\n    setUser(function (prev) {\n      return prev ? _objectSpread(_objectSpread({}, prev), userData) : null;\n    });\n  };\n  var value = {\n    user: user,\n    login: login,\n    register: register,\n    logout: logout,\n    loading: loading,\n    updateUser: updateUser\n  };\n  return _jsx(AuthContext.Provider, {\n    value: value,\n    children: children\n  });\n};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","SecureStore","api","jsx","_jsx","AuthContext","undefined","useAuth","context","Error","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","checkAuthState","_ref2","_asyncToGenerator","token","getItemAsync","defaults","headers","common","fetchUserProfile","error","console","apply","arguments","_ref3","response","get","data","deleteItemAsync","login","_ref4","email","password","post","_response$data","setItemAsync","_error$response","_error$response$data","_x","_x2","register","_ref5","name","_response$data2","_error$response2","_error$response2$data","_x3","_x4","_x5","logout","_ref6","updateUser","userData","prev","_objectSpread","value","Provider"],"sources":["/Users/Pankaj-K/Projects/MERN/ai-stylist-app/mobile-app/src/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport * as SecureStore from 'expo-secure-store';\nimport { api } from '../services/api';\n\ninterface User {\n  id: string;\n  email: string;\n  name: string;\n  avatar?: string;\n  profile?: any;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  login: (email: string, password: string) => Promise<void>;\n  register: (email: string, password: string, name: string) => Promise<void>;\n  logout: () => Promise<void>;\n  loading: boolean;\n  updateUser: (userData: Partial<User>) => void;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuthState();\n  }, []);\n\n  const checkAuthState = async () => {\n    try {\n      const token = await SecureStore.getItemAsync('token');\n      if (token) {\n        api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n        await fetchUserProfile();\n      }\n    } catch (error) {\n      console.error('Auth check failed:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchUserProfile = async () => {\n    try {\n      const response = await api.get('/user/profile');\n      setUser(response.data.user);\n    } catch (error) {\n      console.error('Failed to fetch user profile:', error);\n      await SecureStore.deleteItemAsync('token');\n      delete api.defaults.headers.common['Authorization'];\n    }\n  };\n\n  const login = async (email: string, password: string) => {\n    try {\n      const response = await api.post('/auth/login', { email, password });\n      const { user, token } = response.data;\n      \n      await SecureStore.setItemAsync('token', token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setUser(user);\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Login failed');\n    }\n  };\n\n  const register = async (email: string, password: string, name: string) => {\n    try {\n      const response = await api.post('/auth/register', { email, password, name });\n      const { user, token } = response.data;\n      \n      await SecureStore.setItemAsync('token', token);\n      api.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setUser(user);\n    } catch (error: any) {\n      throw new Error(error.response?.data?.error || 'Registration failed');\n    }\n  };\n\n  const logout = async () => {\n    await SecureStore.deleteItemAsync('token');\n    delete api.defaults.headers.common['Authorization'];\n    setUser(null);\n  };\n\n  const updateUser = (userData: Partial<User>) => {\n    setUser(prev => prev ? { ...prev, ...userData } : null);\n  };\n\n  const value = {\n    user,\n    login,\n    register,\n    logout,\n    loading,\n    updateUser\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}